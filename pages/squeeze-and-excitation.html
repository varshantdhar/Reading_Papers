<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="dcterms.date" content="2023-03-11" />
  <title>Squeeze-and-Excitation Blocks</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
  </style>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Squeeze-and-Excitation Blocks</h1>
<p class="date">2023-03-11</p>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#squeeze-and-excitation-blocks"
id="toc-squeeze-and-excitation-blocks">Squeeze-and-Excitation Blocks</a>
<ul>
<li><a href="#squeeze-global-information-embedding"
id="toc-squeeze-global-information-embedding">Squeeze: Global
Information Embedding</a></li>
<li><a href="#excitation-adaptive-recalibration"
id="toc-excitation-adaptive-recalibration">Excitation: Adaptive
Recalibration</a></li>
</ul></li>
</ul>
</nav>
<h1 id="squeeze-and-excitation-blocks">Squeeze-and-Excitation
Blocks</h1>
<p><a href="https://arxiv.org/pdf/1709.01507.pdf">Squeeze and Excitation
Networks</a></p>
<p>A unit of a transformation <span
class="math inline">\(F_{tr}\)</span> mapping an input <span
class="math inline">\(X \in \R^{H \times W \times C}\)</span> to feature
maps <span class="math inline">\(U \in \R^{H^{&#39;} \times W^{&#39;}
\times C^{&#39;}}\)</span>. Taking <span
class="math inline">\(F_{tr}\)</span> to be a convolution operator and
use <span class="math inline">\(V = [v_1, v_2, \cdots, v_{C}]\)</span>
to denote the learned set of filter, kernels, where <span
class="math inline">\(v_c\)</span> refers to the parameters of the <span
class="math inline">\(c\)</span>-th filter. We can then write the
outputs <span class="math inline">\(U \in \R^{H^{&#39;} \times W^{&#39;}
\times C^{&#39;}}\)</span> as</p>
<p><span class="math display">\[ u_c = v_c * X = \sum_{s=1}^C v_c^s *
x^s \]</span></p>
<p>where <span class="math inline">\(*\)</span> denotes convolution and
<span class="math inline">\(v_c^s\)</span> is a 2D spatial kernel
representing a single channel of <span
class="math inline">\(v_c\)</span> that acts on the corresponding
channel of <span class="math inline">\(X\)</span>. Since the output is a
summation through all channels, channel dependecies are implicitly
embedded in <span class="math inline">\(v_c\)</span>, but are entangled
with the local spatial correlation captured by the filters. The channel
relationships modelled by convolution are inherently implicit and
local.</p>
<p>The learning of convolutional features is expected to be enhanced by
explicitly modelling channel interdependencies, so that the network is
able to increase its sensitivity to informative features which can be
exploited by subsequent transformations. Consequently, providing it with
access to global information and recalibrate filter responses in two
steps, <span class="math inline">\(\textit{squeeze}\)</span> and <span
class="math inline">\(\textit{excitation}\)</span>, before they are fed
into the next transformation.</p>
<h2 id="squeeze-global-information-embedding">Squeeze: Global
Information Embedding</h2>
<p>Each of the learned filters operates with a local receptive field.
Consequently each unit of the transformation output <span
class="math inline">\(U\)</span> is unable to exploit contextual
information outside of this region. “Squeezing” global spatial
information into a channel descriptor aims to mitigate this problem by
using a global average pooling to generate channel=wise statistics.</p>
<p>Formally, a statistic <span class="math inline">\(z \in \R^C\)</span>
is generated by shrinking <span class="math inline">\(U\)</span> through
its spatial dimensions <span class="math inline">\(H \times W\)</span>,
such that the <span class="math inline">\(c\)</span>-th element of <span
class="math inline">\(z\)</span> is calculated by:</p>
<p><span class="math display">\[ z_c = F_{sq}(u_c) = \frac{1}{H \times
W}\sum_{i=1}^{H}\sum_{j=1}^W u_c(i,j)\]</span></p>
<h2 id="excitation-adaptive-recalibration">Excitation: Adaptive
Recalibration</h2>
<p>We follow the <span class="math inline">\(\textit{squeeze}\)</span>
operation with a second operation which aims to fully cpature
channel-wise dependencies. To fulfil this objective, the function
must:</p>
<ul>
<li>Be capable of learning a nonlinear interaction between channels</li>
<li>Learn a non-mutually-exclusive relationship to ensure that multiple
channels are allowed to be emphasised (rather than enforcing a one-hot
activation)</li>
</ul>
<p>The following matches this criteria:</p>
<p><span class="math display">\[s = F_{ex}(z, W) = \sigma(g(z,W)) =
\sigma(W_2 \delta(W_1z))\]</span></p>
<p>where <span class="math inline">\(\delta\)</span> refers to the ReLU
function, <span class="math inline">\(W_1 \in \R^{\frac{C}{r} \times
C}\)</span> and <span class="math inline">\(W_2 \in \R^{C \times
\frac{C}{r}}\)</span>. This gating mechanism is parameterized by forming
a bottleneck with two fully-connected layers around the non-linearity
i.e. a dimensionality-reduction layer with reduction ratio <span
class="math inline">\(r\)</span>, a ReLU and then a
dimensionality-increasing layer returning to the channel dimension of
the transformation output <span class="math inline">\(U\)</span>. The
final output of the block is obtained by rescaling <span
class="math inline">\(U\)</span> with the activations <span
class="math inline">\(s\)</span>:</p>
<p><span class="math display">\[\tilde{x}_c = F_{scale}(u_c, s_c) = s_c
u_c\]</span></p>
<p>where <span class="math inline">\(\tilde{X} =
[\tilde{x_1},\tilde{x_2},\cdots,\tilde{x_c}]\)</span> and <span
class="math inline">\(F_{scale}(u_c, s_c)\)</span> refers to the
channel-wise multiplication between the scalar <span
class="math inline">\(s_c\)</span> and the feature map <span
class="math inline">\(u_c \in \R^{H \times W}\)</span>.</p>
<p>Note, the excitation operator maps the input-specific descriptor
<span class="math inline">\(z\)</span> to a set of channel weights. In
this regard, SE blocks intrinsically introduce dynamics conditioned on
the input, which can be regarded as a self=attention function on
channels whose relationships are not confined to the local receptive
field the convolution filters are repsonsive to.</p>
<figure>
<img src="assets/images/squeeze-and-excitation-blocks/seblocks.png">
</figure>
</body>
</html>
